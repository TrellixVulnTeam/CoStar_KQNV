-file("test/lib/kernel/test/error_handler_SUITE.erl", 1).

-module(error_handler_SUITE).

-export([all/0,
         suite/0,
         groups/0,
         init_per_suite/1,
         end_per_suite/1,
         init_per_group/2,
         end_per_group/2,
         undefined_function_handler/1]).

-export(['$handle_undefined_function'/2]).

suite() ->
    [{ct_hooks,[ts_install_cth]}].

all() ->
    [undefined_function_handler].

groups() ->
    [].

init_per_suite(Config) ->
    Config.

end_per_suite(_Config) ->
    ok.

init_per_group(_GroupName, Config) ->
    Config.

end_per_group(_GroupName, Config) ->
    Config.

undefined_function_handler(_) ->
    42 = error_handler_SUITE:forty_two(),
    42 = (id(error_handler_SUITE)):forty_two(),
    {ok,{a,b,c}} = error_handler_SUITE:one_arg({a,b,c}),
    {ok,{a,b,c}} = (id(error_handler_SUITE)):one_arg({a,b,c}),
    {'EXIT',
     {undef,
      [{error_handler_SUITE,undef_and_not_handled,[[1,2,3]],[]}|_]}} =
        (catch error_handler_SUITE:undef_and_not_handled([1,2,3])),
    ok.

'$handle_undefined_function'(forty_two, []) ->
    42;
'$handle_undefined_function'(one_arg, [Arg]) ->
    {ok,Arg};
'$handle_undefined_function'(Func, Args) ->
    error_handler:raise_undef_exception(error_handler_SUITE, Func, Args).

id(I) ->
    I.



