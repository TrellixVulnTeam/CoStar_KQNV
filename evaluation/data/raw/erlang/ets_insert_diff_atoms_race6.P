-file("test/lib/dialyzer/test/race_SUITE_data/src/ets_insert_diff_atoms_race6.erl",
      1).

-module(ets_insert_diff_atoms_race6).

-export([test/0]).

test() ->
    ets:new(foo, [named_table,public]),
    {race(foo, counter),no_race(foo, counter)}.

race(Tab, Counter) ->
    [{_,N}] = ets:lookup(Tab, Counter),
    aux(Tab, Counter, N).

no_race(Tab, Counter) ->
    [{_,N}] = ets:lookup(Tab, Counter),
    AnotherCounter = index,
    aux(Tab, AnotherCounter, N).

aux(Table, Counter, N) ->
    ets:insert(Table, {Counter,N + 1}).



